!function(a){"use strict";a(function(){function b(b){return a.inArray(b.toUpperCase(),sc_script.zero_decimal_currencies)>1}function c(a,c){c=c.toUpperCase(),a=b(c)?Math.round(a):(a/100).toFixed(2);var d="";return d="USD"===c?"$"+a:a+" "+c}var d=a("body"),e=d.find(".sc-checkout-form"),f=e.find(".sc-cf-date");f.pikaday({format:"M/D/YYYY"});var g=e.find(".sc-cf-checkbox");g.change(function(){var b=a(this),c=b.prop("id"),e=d.find("#"+c+"_hidden");e.val(b.is(":checked")?"Yes":"No")}),e.each(function(){var d=a(this);1!=d.has(".sc-payment-btn").length&&(1==sc_script[1].is_admin&&d.before("<p>"+sc_script[1].invalid_html_string+"</p>"),d.find(".sc-payment-btn").prop("disabled",!0));var e=d.data("sc-id")||"",f=d.find(".sc-cf-amount");f.length>0&&f.on("change",function(){if(f.is('input[type="radio"]'))var a=d.find(".sc-cf-amount:checked").data("sc-price");else var a=d.find(".sc-cf-amount option:selected").data("sc-price");var b=d.find(".sc-coup-coupon-code").val();d.find(".sc-coup-remove-coupon").click(),sc_script[e].originalAmount=a,sc_script[e].amount=a,d.find(".sc-total-amount").text(c(a,sc_script[e].currency)),d.find(".sc-coup-coupon").val(b),d.find(".sc-coup-apply-btn").click()}),sc_script[e].originalAmount=sc_script[e].amount,d.parsley({errorsContainer:function(a){return a.closest(".sc-form-group")}}),d.find(".sc-payment-btn").on("click.scpPaymentBtn",function(c){if(d.parsley().validate()){var f=sc_script[e].amount,g=d.find(".sc-uea-custom-amount").val();g&&(f=b(sc_script[e].currency)?Math.round(g):Math.round(parseFloat(100*g)));var h=d.find(".sc-cf-quantity");h.length>0&&(h=h.is('input[type="radio"]')?d.find(".sc-cf-quantity:checked").val():d.find(".sc-cf-quantity").val(),h>0&&(f=parseInt(h)*f));var i=StripeCheckout.configure({key:sc_script[e].key,image:-1!=sc_script[e].image?sc_script[e].image:"",token:function(b,c){d.find(".sc_stripeToken").val(b.id),d.find(".sc_stripeEmail").val(b.email),d.find(".sc_amount").val(f),a.isEmptyObject(c)||(d.find(".sc-shipping-name").val(c.shipping_name),d.find(".sc-shipping-country").val(c.shipping_address_country),d.find(".sc-shipping-zip").val(c.shipping_address_zip),d.find(".sc-shipping-state").val(c.shipping_address_state),d.find(".sc-shipping-address").val(c.shipping_address_line1),d.find(".sc-shipping-city").val(c.shipping_address_city)),d.unbind("submit"),d.submit(),d.find(".sc-payment-btn").prop("disabled",!0).find("span").text("Please wait...")},alipay:1==sc_script[e].alipay||"true"==sc_script[e].alipay?!0:!1,alipayReusable:1==sc_script[e].alipay_reusable||"true"==sc_script[e].alipay_reusable?!0:!1,locale:-1!=sc_script[e].locale?sc_script[e].locale:""}),j={name:-1!=sc_script[e].name?sc_script[e].name:"",description:-1!=sc_script[e].description?sc_script[e].description:"",amount:f,currency:-1!=sc_script[e].currency?sc_script[e].currency:"USD",panelLabel:-1!=sc_script[e].panelLabel?sc_script[e].panelLabel:"Pay {{amount}}",billingAddress:"true"==sc_script[e].billingAddress||1==sc_script[e].billingAddress?!0:!1,shippingAddress:"true"==sc_script[e].shippingAddress||1==sc_script[e].shippingAddress?!0:!1,allowRememberMe:1==sc_script[e].allowRememberMe||"true"==sc_script[e].allowRememberMe?!0:!1,bitcoin:1==sc_script[e].bitcoin||"true"==sc_script[e].bitcoin?!0:!1,zipCode:1==sc_script[e].zipCode||"true"==sc_script[e].zipCode?!0:!1};-1!=sc_script[e].email&&(j.email=sc_script[e].email),i.open(j)}c.preventDefault()}),d.find(".sc-coup-apply-btn").on("click.scpCouponApply",function(b){b.preventDefault(),d.find(".sc-coup-remove-coupon").click(),d.find(".sc-coup-validation-message").empty();var f=d.find(".sc-coup-coupon").val();if(f){d.find(".sc-coup-loading").show();var g=d.find('input[name="sc_test_mode"]');g=g.length>0?"true":"false";var h={action:"sc_coup_get_coupon",coupon:f,amount:sc_script[e].amount,test_mode:g};a.post(sc_coup.ajaxurl,h,function(a){if(a.success){var b=a.message,f=a.coupon;sc_script[e].amount=b,d.find(".sc-coup-coupon-code").val(f.code),d.find(".sc-coup-coupon").val(""),d.find(".sc-coup-success-message").empty(),d.find(".sc-coup-remove-coupon").hide();var g=f.code+": ";"percent"==f.type?g+=f.amountOff+"% off":"amount"==f.type&&(g+=c(f.amountOff,sc_script[e].currency)+" off"),d.find(".sc-coup-success-message").text(g),d.find(".sc-coup-remove-coupon").show(),d.find(".sc-total-amount").text(c(b,sc_script[e].currency))}else d.find(".sc-coup-validation-message").text(a.message);d.find(".sc-coup-loading").hide()},"json")}}),d.find(".sc-coup-remove-coupon").on("click.scpCouponRemove",function(a){a.preventDefault(),sc_script[e].amount=sc_script[e].originalAmount,d.find(".sc-coup-coupon-code").val(""),d.find(".sc-coup-success-message").empty(),d.find(".sc-coup-remove-coupon").hide(),d.find(".sc-total-amount").text(c(sc_script[e].amount,sc_script[e].currency))}),d.find(".sc-uea-custom-amount").on("keyup",function(){"USD"==sc_script[e].currency?d.find(".sc-total-amount").html("$"+a(this).val()):d.find(".sc-total-amount").html(a(this).val()+" "+sc_script[e].currency)})}),d.find(".sc-uea-custom-amount").on("keypress",function(a){44==a.which&&a.preventDefault()})})}(jQuery);